# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Impute missing values in a matrix using k-nearest neighbors (k-NN) with brute-force
#'
#' This function imputes missing values in a matrix using a k-nearest neighbors
#' approach based on the specified distance metric. It processes only columns
#' with missing values, calculating distances to other columns to find the
#' k-nearest neighbors, and imputes missing values using either a simple average
#' or a weighted average (inverse distance weighting) of non-missing values from
#' these neighbors, depending on the `weighted` parameter.
#'
#'
#' @param obj Numeric matrix with missing values represented as NA (NaN).
#' @param miss Logical matrix (0/1) indicating missing values (1 = missing).
#' @param k Number of nearest neighbors to use for imputation.
#' @param n_col_miss Integer vector specifying the count of missing values per column.
#' @param method Integer specifying the distance metric: 0 = Euclidean, 1 = Manhattan, 2 = impute.knn method.
#' @param weighted Boolean controls for the imputed value to be a simple mean or weighted mean by inverse distance.
#'   Note: Forced to FALSE when `n_imp > 1`.
#' @param dist_pow A positive double that controls the penalty for larger distances in
#' the weighted mean imputation. Must be greater than zero: values between 0 and 1 apply a softer penalty,
#' 1 is linear (default), and values greater than 1 apply a harsher penalty.
#' @param n_imp Integer specifying the number of replicates for imputation (default = 1). If > 1, enables multiple imputation.
#' @param n_pmm Integer specifying the number of donors for pmm.
#' @param seed Integer seed for random number generation during bootstrapping (default = 42). Only used when `n_imp > 1`.
#' @param cores Number of CPU cores to use for parallel processing (default = 1).
#' @return A matrix where the first column is the 1-based row index, the second column is the 1-based column index,
#' and the subsequent `n_imp` columns contain the imputed values (one column per bootstrap replicate if `n_imp > 1`).
#'
#' @export
impute_knn_brute <- function(obj, miss, k, n_col_miss, method, weighted, dist_pow, n_imp = 1L, n_pmm = 0L, seed = 42L, cores = 1L) {
    .Call(`_SlideKnn_impute_knn_brute`, obj, miss, k, n_col_miss, method, weighted, dist_pow, n_imp, n_pmm, seed, cores)
}

#' @title Find K-Nearest Neighbors for Columns with Missing Values
#'
#' @description
#' This function returns the information of nearest neighbors found.
#' Used for benchmarking and unit testing logic of \code{impute_knn_brute} only.
#'
#' @param obj R matrix
#' @param miss is.na(obj)
#' @param k n neighbor
#' @param n_col_miss Integer vector specifying the count of missing values per column.
#' @param n_col_name Character vector of same length as n_col_miss containing column names.
#' @param method distance metric
#' @param cores n cores
#'
#' @return
#' A named list where each element corresponds to one column with missing values
#' (i.e., where n_col_miss > 0). Each sub-list contains:
#'
#' \itemize{
#'   \item \code{indices}: An integer vector of 1-based indices of the nearest neighbor columns.
#'   \item \code{distances}: A numeric vector of distances to the nearest neighbors.
#'   \item \code{n_neighbors}: The number of valid neighbors found.
#' }
#'
#' If no columns have missing values, an empty list is returned.
#'
#' @export
find_knn_brute <- function(obj, miss, k, n_col_miss, n_col_name, method, cores = 1L) {
    .Call(`_SlideKnn_find_knn_brute`, obj, miss, k, n_col_miss, n_col_name, method, cores)
}

#' Impute missing values in a matrix using treed k-nearest neighbors (k-NN)
#'
#' k-NN using KDTree or BallTree with optional bootstrap support for uncertainty estimation.
#'
#' When `n_imp > 1`, bootstrapping is enabled: for each missing value, `n_imp` imputed values are generated
#' by resampling the k nearest neighbors with replacement and using simple averages (weighted is forced to FALSE).
#' This provides variability estimates for imputation uncertainty.
#'
#' @param obj Numeric matrix with missing values pre-filled with colMeans.
#' @param miss Logical matrix (0/1) indicating missing values (1 = missing).
#' @param k Number of nearest neighbors to use for imputation.
#' @param n_col_miss Integer vector specifying the count of missing values per column.
#' @param method Integer specifying the distance metric: 0 = Euclidean, 1 = Manhattan.
#' @param tree Which type of tree? "kd" or "ball".
#' @param weighted Boolean controls for the imputed value to be a simple mean or weighted mean by inverse distance.
#'   Note: Forced to FALSE when `n_imp > 1`.
#' @param dist_pow A positive double that controls the penalty for larger distances in
#' the weighted mean imputation. Must be greater than zero: values between 0 and 1 apply a softer penalty,
#' 1 is linear (default), and values greater than 1 apply a harsher penalty.
#' @param n_imp Integer specifying the number of bootstrap replicates for imputation (default = 1). If > 1, enables bootstrapping.
#' @param n_pmm Integer specifying the number of donors for pmm.
#' @param seed Integer seed for random number generation during bootstrapping (default = 42). Only used when `n_imp > 1`.
#' @param cores Number of CPU cores to use for parallel processing (default = 1).
#' @return A matrix where the first column is the 1-based row index, the second column is the 1-based column index,
#' and the subsequent `n_imp` columns contain the imputed values (one column per bootstrap replicate if `n_imp > 1`).
#'
#' @export
impute_knn_mlpack <- function(obj, miss, k, n_col_miss, method, tree, weighted, dist_pow, n_imp = 1L, n_pmm = 0L, seed = 42L, cores = 1L) {
    .Call(`_SlideKnn_impute_knn_mlpack`, obj, miss, k, n_col_miss, method, tree, weighted, dist_pow, n_imp, n_pmm, seed, cores)
}

