% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/knn_imp.R
\name{knn_imp}
\alias{knn_imp}
\title{K-Nearest Neighbor Imputation for Missing Values}
\usage{
knn_imp(
  obj,
  k,
  colmax = 0.9,
  method = c("euclidean", "manhattan"),
  cores = 1,
  post_imp = TRUE,
  subset = NULL,
  dist_pow = 1,
  tree = NULL,
  ...
)
}
\arguments{
\item{obj}{A numeric matrix with \strong{samples in rows} and \strong{features in columns}.}

\item{k}{Number of nearest neighbors for imputation. 10 is a good starting point.}

\item{colmax}{Numeric. Threshold proportion of missing values per column (0-1).
Columns exceeding this threshold are imputed using column means instead of
k-NN when \code{post_imp = TRUE}. Default: 0.9.}

\item{method}{Character. Distance metric for k-NN: \code{"euclidean"} or \code{"manhattan"}.
Default: \code{"euclidean"}.}

\item{cores}{Integer. Number of CPU cores for parallel distance computation. Default: 1.}

\item{post_imp}{Logical. Whether to impute remaining missing values with
column means after k-NN imputation. Default: \code{TRUE}.}

\item{subset}{Character vector of column names or integer vector of column
indices specifying which columns to impute.}

\item{dist_pow}{Numeric. Positive value controlling distance penalty in weighted
imputation. Values < 1 apply softer penalty, 1 is linear, > 1 is harsher.
Only used when \code{weighted = TRUE}. Default: 1.}

\item{tree}{Character. k-NN search method: \code{NULL} (brute-force), \code{"kd"} (KDTree),
or \code{"ball"} (BallTree). Tree methods use mlpack implementation but may be
biased with high missing value percentages. Default: \code{NULL}.}

\item{...}{Currently not implemented.}
}
\value{
A list of length \code{n_imp} containing numeric matrices or \code{\link[bigmemory:big.matrix]{bigmemory::big.matrix()}}
objects (if \code{output} is specified) with the same dimensions as \code{obj}. Missing values
are imputed using k-NN for columns with missingness below \code{colmax}, and mean
imputation for remaining missing values if \code{post_imp = TRUE}.
}
\description{
Imputes missing values in numeric matrices using the k-nearest neighbors algorithm
with a two-stage approach: k-NN imputation for columns with missingness below a
threshold, followed by optional mean imputation for remaining missing values.
}
\details{
This function performs \strong{column-wise} nearest neighbor calculations.

When \code{weighted = TRUE}, imputed values are computed as distance-weighted averages
where weights are inverse distances raised to the power of \code{dist_pow}. This gives
closer neighbors greater influence in the imputation process, which can increase
predictive performance.

The \code{tree} parameter enables faster neighbor search using spatial data structures
but requires pre-filling missing values with column means, which may introduce bias
in high-missingness data. Tree construction overhead may reduce performance for
low-dimensional data or small k values.
}
\section{Performance Optimization}{

\itemize{
\item \strong{Tree methods}: Only use when imputation runtime becomes prohibitive and missingness is low (<20\% missing)
\item \strong{Subset imputation}: Use \code{subset} parameter for efficiency when only specific columns need imputation
}
}

\examples{
data(khanmiss1)
sum(is.na(khanmiss1))

# Basic k-NN imputation (khanmiss1 has genes in rows, so transpose)
t_khanmiss1 <- t(khanmiss1)
result <- knn_imp(t_khanmiss1, k = 5)
result

}
\references{
Robert Tibshirani, Trevor Hastie, Balasubramanian Narasimhan, and Gilbert Chu (2002).
Diagnosis of multiple cancer types by shrunken centroids of gene expression
PNAS 99: 6567-6572. Available at www.pnas.org
}
